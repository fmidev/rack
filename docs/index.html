<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rack: Rack - a weather radar data processing program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="rack.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rack-logo-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><!-- rack /-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Rack - a weather radar data processing program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#intro">Introduction</a></li>
<li class="level1"><a href="#commands">Usage</a><ul><li class="level2"><a href="#command_line_format">Command line arguments</a></li>
<li class="level2"><a href="#products_brief">Meteorological products</a></li>
<li class="level2"><a href="#cartesian_brief">Converting to Cartesian images</a></li>
<li class="level2"><a href="#selecting">Selecting data</a><ul><li class="level3"><a href="#selectquantity">Selecting by quantity only</a></li>
</ul>
</li>
<li class="level2"><a href="#target">Defining target data properties</a></li>
<li class="level2"><a href="#quantityConf">Default encoding of quantities</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><em> </em> <em> </em></p>
<div class="image">
<img src="rack-logo-384x192.png" alt=""/>
</div>
 <div class="fragment"></div><!-- fragment --><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p><b>Rack</b> is a command-line program for processing weather radar data. It uses raw measurement data as input and generates <a class="el" href="productspage.html">Meteorological products</a> as well as <a class="el" href="compositespage.html">Cartesian conversions and composites</a> . <b>Rack</b> also provides methods for <a class="el" href="andrepage.html">Anomaly Detection and Removal (AnDRe)</a> . Quality information is supported throughout the processing chain. <b>Rack</b> also supports <a class="el" href="imagespage.html">Image processing</a> , like applying colors and transparency.</p>
<p><b>Rack</b> is based on code developed at the Finnish Meteorological Institute since 2001. Part of the development work has been supported by the BALTRAD project (2009-2014), see <a href="http://www.baltrad.eu">http://www.baltrad.eu</a> . The program can be downloaded from <a href="https://github.com/fmidev/rack">https://github.com/fmidev/rack</a> .</p>
<p>As input, <b>Rack</b> accepts azimuthal scans - volumes or separate sweeps - in HDF5 files using OPERA Information Model (ODIM, <a href="http://www.eumetnet.eu/opera">http://www.eumetnet.eu/opera</a>).</p>
<p>After loading a volume file, a typical operation is to compute a single-radar product. The computation is carried out in polar coordinates. The result can be mapped to a Cartesian products. The projections are calculated using the Proj4 library (<a href="http://trac.osgeo.org/proj/">http://trac.osgeo.org/proj/</a>). Output files can be written in HDF5 files, PNG image files or geo-referenced GeoTIFF files. In addition, metadata, resampled grid data and vertical profiles can be output as plain text files.</p>
<p>The overall data flow is illustrated below. <br  />
</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_10.png" alt="dot_inline_dotgraph_10.png" border="0" usemap="#dot_inline_dotgraph_10.map"/>
<map name="dot_inline_dotgraph_10.map" id="dot_inline_dotgraph_10.map"><area shape="rect" href="fileiopage.html" title="Input file\nHDF5 (or PNG+TXT)" alt="" coords="4,116,118,151"/>
<area shape="rect" href="fileiopage.html" title="Input volume" alt="" coords="152,116,231,151"/>
<area shape="poly" href="andrepage.html" title="Anomaly detection\n and removal" alt="" coords="421,134,417,128,407,122,391,118,370,115,347,114,325,115,304,118,288,122,277,128,274,134,277,140,288,145,304,150,325,152,347,153,370,152,391,150,407,145,417,140"/>
<area shape="poly" href="productspage.html" title="Product generation\n(in polar coordinates)" alt="" coords="429,78,425,72,414,66,396,62,373,59,347,58,322,59,299,62,281,66,269,72,265,78,269,84,281,90,299,94,322,97,347,98,373,97,396,94,414,90,425,84"/>
<area shape="poly" href="compositespage.html" title="Cartesian products\n and compositing" alt="" coords="772,80,768,74,757,68,741,64,720,61,697,60,675,61,654,64,637,68,627,74,623,80,627,86,637,91,654,96,675,99,697,99,720,99,741,96,757,91,768,86"/>
<area shape="rect" href="fileiopage.html" title="Output file\nHDF5, GeoTIFF, or PNG" alt="" coords="1019,135,1148,169"/>
<area shape="rect" href="productspage.html" title="Meteorological product" alt="" coords="464,63,589,97"/>
<area shape="rect" href="compositespage.html" title="Cartesian product" alt="" coords="858,91,958,126"/>
<area shape="rect" href="compositespage.html" title="Composite\n(Internal accumulation array)" alt="" coords="831,40,985,75"/>
</map>
</div>
<h1><a class="anchor" id="commands"></a>
Usage</h1>
<h2><a class="anchor" id="command_line_format"></a>
Command line arguments</h2>
<p>A typical invocation of <b>Rack</b> looks like: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> &lt;input-files&gt;  &lt;command&gt; -o &lt;file1&gt;   &lt;command2&gt; -o &lt;file2&gt;  ...</div>
<div class="ttc" id="anamespacerack_html"><div class="ttname"><a href="namespacerack.html">rack</a></div><div class="ttdef"><b>Definition:</b> DataSelector.cpp:44</div></div>
</div><!-- fragment --><p>The native format for data is HDF5, but data and be read or written partially using image and text format. See <a class="el" href="fileiopage.html">File input and output</a> for details.</p>
<p>Specifically, <b>Rack</b> accepts three kinds of command line arguments:</p>
<ol type="1">
<li>options without arguments, like <code>&ndash;help</code> </li>
<li>options with arguments, like <code>&ndash;outputFile</code> <code>product.h5</code> </li>
<li>plain arguments recognized as input filenames, like <code>volume.h5</code> , serving as shorthand for <code>&ndash;inputFile</code> <code>&lt;file&gt;</code> .</li>
</ol>
<p>The options are prefixed with double hyphen, "--". Some options have also a single hyphen "-", single-letter shorthand. (This argument syntax differs from POSIX and GNU conventions, e.g. <code>-x</code> <code>-y</code> cannot be grouped to <code>-xy</code>. ) All the arguments are handled in order; they can be thought as commands to be executed sequentially.</p>
<p>Usage info and a list of commands is dumped if <code>&ndash;help</code> or <code>-h</code> or no arguments are supplied: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --help</div>
</div><!-- fragment --><p> The list of commands is also listed in Section <a class="el" href="quickpage.html#commands_general">General commands</a>.</p>
<p>Help is also available for invidual commands: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --help &lt;command&gt;</div>
</div><!-- fragment --><p>The version of the program is displayed with <code>&ndash;version</code>. <br  />
 Other useful general commands are <code>&ndash;verbose</code> <code>&lt;level&gt;</code> and <code>&ndash;status</code>, which give debugging information of data flow and memory.</p>
<h2><a class="anchor" id="products_brief"></a>
Meteorological products</h2>
<p>Generation of a single-radar product is explained in section <a class="el" href="productspage.html">Meteorological products</a>. The products are generated in polar coordinates, that is, in radar's native coordinate system. <br  />
 A product may contain additional data arrays, typically quality indices or height information. As processing and using Doppler data involves special aspects, it is handled in it own section, <a class="el" href="motionpage.html#doppler">Basic Doppler products</a>.</p>
<p>A product can be further converted to Cartesian coordinate system, explained next.</p>
<h2><a class="anchor" id="cartesian_brief"></a>
Converting to Cartesian images</h2>
<p>Data in polar coordinates can be mapped to a Cartesian product with <code>&ndash;cCreate</code> (abbreviated <code>-c</code>). The simplest possible command is </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --cCreate -o cartesian.h5</div>
</div><!-- fragment --><p> which converts the first dataset (sweep) in volume.h5 to a Cartesian product. The default projection is azimuthal equidistant, centered at the radar. The projection can be changed with <code>&ndash;cProj</code> which uses <b>Proj.4</b> syntax (<a href="http://trac.osgeo.org/proj/">http://trac.osgeo.org/proj/</a>). The default size (bins x bins) can be changed with <code>&ndash;cSize</code> .</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --cSize 400,400 --cProj <span class="stringliteral">&#39;+proj=stere +lon_0=25.0 +lat_0=60.000&#39;</span> --cCreate -o cartesian-stere.h5</div>
</div><!-- fragment --><div class="image">
<img src="cartesians.png" alt=""/>
<div class="caption">
Data remapped with <code>--cCreate</code> , further coloured with <code>--palette</code> , displayed with a legend generated with <code>--legendOut</code> .</div></div>
 <p>The above image contains some anomalies that can be detected and removed. See <a class="el" href="andrepage.html">Anomaly Detection and Removal (AnDRe)</a> for details.</p>
<p>Inside <b>Rack</b> , a single-radar Cartesian product is technically similar to a radar composite &ndash; it is a single-radar "composite". The related commands are prefixed with <code>'c'</code>. Composite generation, projections, methods, and other options are explained in further detail in section <a class="el" href="compositespage.html">Cartesian conversions and composites</a> .</p>
<h2><a class="anchor" id="selecting"></a>
Selecting data</h2>
<p>This command determines the data to be applied in subsequent input read or product generation commands.</p>
<p>In <b>Rack</b>, many operations implictly select a subset of available data instead of using it all. For example, in computing a Pseudo CAPPI image, <code>DBZH</code> data from single-PRF sweeps is used by default.</p>
<p><b>Synopsis</b> </p><div class="fragment"></div><!-- fragment --><p>Remarks on the options:</p>
<ul>
<li><code>path</code> argument defines a path <em>segment</em> to be matched, with desired index ranges (example: <code>dataset2:4/data3</code>:8 )</li>
<li>in <code>path</code> argument, a leading slash fixes the matching to the root (example: <code>/dataset</code>:/data: ), otherwise the tail part is matched</li>
<li><code>quantity</code> argument accepts a list of strings separated by semicolon ':'</li>
<li>each item in a <code>quantity</code> argument list can be a literal string like <code>DBZH</code> or a regular experession like <code>^DBZ[HV]?$</code></li>
</ul>
<p>See example sets below!</p>
<p>This option is useful in selecting data for:</p>
<ul>
<li>partial reading a large input file (see <a class="el" href="fileiopage.html">File input and output</a> ).</li>
<li>a meteorological product (see <a class="el" href="productspage.html">Meteorological products</a> ).</li>
<li>compositing (see <a class="el" href="compositespage.html">Cartesian conversions and composites</a> ).</li>
<li>saving images (PNG, GeoTIFF, PPM; see <a class="el" href="imagespage.html">Image processing</a> ).</li>
<li>other data dumps, useful in debugging, for example</li>
</ul>
<p>The following command lines illustrate usage of <code>&ndash;select</code> in product generation and image output.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># For a Pseudo CAPPI product, change default input selection</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;quantity=^TH$,elangle=1.5:10,count=3&#39;</span> --pCappi 1500 -o pCappi-TH-1500m.h5</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For image output, select DBZH  </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select elangle=1.5,quantity=DBZH -o volume-DBZH.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For image output, select VRAD of the lowest dual-PRF scan </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=VRAD:VRADH,order=ELANGLE:MIN,prf=DOUBLE -o volume-VRAD.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For image output, select ZDR of the highest single-PRF scan </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=ZDR,count=1,order=ELANGLE:MAX,prf=SINGLE -o volume-ZDR.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For single-image output, select DBZH of the lowest scan (from 90 6.5 2.4 1.8 1.2 0.59)</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=DBZH,order=ELANGLE:MIN -o volume-DBZH2.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For single-image output, select dBZ - preferably total dBZ - of the highest scan (from 90 6.5 2.4 1.8 1.2 0.59)</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=TH:TV:T:DBZH:DBZ,order=ELANGLE:MAX -o volume-DBZH3.png</div>
<div class="line"> </div>
</div><!-- fragment --><p>The following examples are less realistic than those above, but are used in unit testing of the program code.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Index range: select dataset3, including its subgroups. </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select /dataset3 -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Index range: select DATASET groups with index 2...5, including subgroups. </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select /dataset2:5 -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Index range test: select DATASET groups with index 3 at least.</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select /dataset3: -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Index range test: select DATASET groups with index 3 at largest. </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select /dataset:3 -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For text output, select paths ENDING with &#39;what&#39;, &#39;where&#39;, or &#39;how&#39;. </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;what|where|how&#39;</span> -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For text output, select paths of elevations of at least 6.0 degrees </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select elangle=6.0 -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For text output, select paths of elevations up to 6.0 degrees </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select elangle=:6.0 -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For text output, select &#39;where&#39; groups of 3 lowest elevations from 0.5 degrees upwards </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select where,elangle=0.5:90.0,count=3 -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For text output, select &#39;what&#39; and &#39;where&#39; groups of elevations from 0.5 to 6.0 degrees</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;what|where,elangle=0.5:6&#39;</span> -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Select a unique quality field</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=CLASS-ETOP -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Select all QIND fields</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=QIND -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Select global (dataset-level) QIND fields</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=/QIND -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Select quantity-specific (data-level) QIND fields</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=.+/QIND -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Select quantity-specific (data-level) QIND field</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=DBZ-SLOPE-SMOOTH/QIND -o volume-select.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Select non-existing quantity-specific QIND field</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=HGHT/QIND -o volume-select.txt</div>
<div class="line"> </div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>CmdDelete </dd>
<dd>
CmdKeep </dd>
<dd>
CmdSetODIM </dd>
<dd>
<a class="el" href="classrack_1_1CmdSelect.html" title="Select parts of hierarchical data using path, quantity, elevation angle and PRF mode as selection cri...">rack::CmdSelect</a> (code) </dd>
<dd>
<a class="el" href="classrack_1_1DataSelector.html" title="Tool for selecting datasets based on paths, quantities and min/max elevations.">rack::DataSelector</a> (code)</dd></dl>
<h3><a class="anchor" id="selectquantity"></a>
Selecting by quantity only</h3>
<p>Most commands apply implicit input data selection criteria, typically involving data paths, quantities and/or elevation angles.</p>
<p>Like in general in <b>Rack</b>, the parameters of <code>&ndash;select</code> are positional (ordered), meaning that they can be issued as a comma-separated string without explicit names (keywords), as long as they are given in order. The parameters are:</p>
<ul>
<li><code>path</code> is a string of path elements, separated by slash '/' and consisting of:<ul>
<li>a leading single slash '/', if rooted matching is desired ie. leading parts of the paths are tested; otherwise trailing parts</li>
<li><code>what</code> , <code>where</code>, <code>how</code> - ie. the groups containing attributes</li>
<li><code> dataset{min}:{max} </code>, <code> data{min}:{max}</code> , <code> quality{min}:{max}</code> - indexed groups containing subgroups for actual data and attributes</li>
<li><code>data</code> - unindexed groups containing actual data arrays</li>
<li><em>combined</em> <em>selection</em> <em>elements</em> created by concatenating above elements with pipe '|' representing logical OR function (requires escaping on command line)<ul>
<li>example: <code>what|where|dataset1:3</code></li>
</ul>
</li>
<li>in index ranges, values can be omitted, using invoking default minimum (1) and maximum (0xffff = 65535) as follows:<ul>
<li><code>data:</code> equals <code>data1:65535</code>; further the colon ':' can be omitted for <code>dataset</code> and <code>quality</code> (but not for <code>data:</code> , to bypass naming conflict inherent in ODIM )</li>
<li><code>data{index}</code> equals <code> data{index}:{index}</code> (ie. exact match)</li>
<li><code>data{index}:</code> equals <code> data{index}:65535</code></li>
<li><code>data:{index}</code> equals <code> data1:{index}</code></li>
</ul>
</li>
<li>in each combined selection element, only one index range can be given, referring to all indexed elements, and it must be given as the last segment<ul>
<li>example: <code>what|data|quality1:5</code> matches <code>what</code>, <code>data1:5</code> and <code>quality1:5</code></li>
<li>example: <code>what|where|dataset1:3/what|data1:8</code> &ndash; index ranges <em>can</em> <em>vary</em> on different levels, ie. in slash-separated elements</li>
</ul>
</li>
</ul>
</li>
<li><code>quantity</code> is a regular expression<ul>
<li>example: <code>^DBZH$</code>, accepting <code>DBZH</code> only</li>
<li>example: <code>(DBZH|TH)</code> accepts <code>DBZH</code> and <code>TH</code> , but also <code>DBZHC</code> and <code>WIDTH</code> ...</li>
<li>future option: two regular expressions separated by a slash, the latter regExp determining the desired quality quantities</li>
</ul>
</li>
<li><code>elangle</code> defines the range of antenna elevations accepted, range limits included<ul>
<li>unlike with path selectors, <code>elangle={angle}</code> abbreviates <code>elangle={angle}:90</code> (not <code>elangle={angle}:{angle}</code>)</li>
<li>notice that metadata may contain floating point values like 1.000004723, use <code>count=1</code> to pick a single one within a range</li>
</ul>
</li>
<li><code>count</code> is the upper limit of accepted indices of <code>dataset</code> ; typically used with <code>elangle</code> </li>
<li><code>order</code> defines criteria <code></code>(DATA|TIME|ELANGLE) and operation <code></code>(MIN|MAX) in selecting data, applied with <code>count</code>. Note that the lowest elevations can be measured the latest, appearing as <code>dataset</code> 's with highest indices.</li>
<li><code>dualPRF</code> determines if sweeps using dual pulse repetition frequency is required (1), accepted like single one (0), or excluded (-1).</li>
</ul>
<p>The selection functionality is best explained with examples.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># For a Pseudo CAPPI product, change default input selection</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;quantity=^TH$,elangle=1.5:10,count=3&#39;</span> --pCappi 1500 -o pCappi-TH-1500m.h5</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For image output, select DBZH  </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select elangle=1.5,quantity=DBZH -o volume-DBZH.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For image output, select VRAD of the lowest dual-PRF scan </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=VRAD:VRADH,order=ELANGLE:MIN,prf=DOUBLE -o volume-VRAD.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For image output, select ZDR of the highest single-PRF scan </span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=ZDR,count=1,order=ELANGLE:MAX,prf=SINGLE -o volume-ZDR.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For single-image output, select DBZH of the lowest scan (from 90 6.5 2.4 1.8 1.2 0.59)</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=DBZH,order=ELANGLE:MIN -o volume-DBZH2.png</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># For single-image output, select dBZ - preferably total dBZ - of the highest scan (from 90 6.5 2.4 1.8 1.2 0.59)</span></div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select quantity=TH:TV:T:DBZH:DBZ,order=ELANGLE:MAX -o volume-DBZH3.png</div>
<div class="line"> </div>
</div><!-- fragment --><p> Note that escaping special characters like '|' is often required on command line.</p>
<p>Often, the first data array matching the criteria are used.</p>
<p>One can explicitly change the criteria with <code>&ndash;select</code> (<code>-s</code>) command . For example, in data conversions one may wish to focus on certain quantity &ndash; like <code>DBZH</code> or <code>VRAD</code> &ndash; not all the data.</p>
<p>The selection command can be applied the most commands processing data. In computing meteorological products (<a class="el" href="productspage.html#products">Product generation</a>) an compositing, it affects the following product only. In case of anomaly detectors (<a class="el" href="andrepage.html">Anomaly Detection and Removal (AnDRe)</a>), it applies to all subsequent operators.</p>
<p>Note that some processing commands may not support explicit data selection. Set selection criteria strictly to one <code>quantity</code> . Selecting quantities only is frequently needed, so there is a dedicated command <code>&ndash;selectQuantity</code> (<code>-Q</code> ) which accepts comma-separated simple patterns (with * and ?) instead of regular expressions. For example, <code>-Q</code> <code>DBZH*</code>,QIND is equal to <code>&ndash;select</code> <code>quantity='^</code>(DBZH.*|QIND)$' .</p>
<div class="image">
<img src="ppi-RHOHV-panel.png" alt=""/>
<div class="caption">
Data selected with -Q RHOHV and coloured with <code>--palette</code>.</div></div>
 <h2><a class="anchor" id="target"></a>
Defining target data properties</h2>
<p>The desired output storage type, scaling, and encoding can be set with <code>&ndash;encoding</code> command. Depending on the following command, a varying set of properties will be supported. The general form of <code>&ndash;encoding</code> command is </p><div class="fragment"><div class="line">rack &lt;input&gt;  --encoding &lt;type&gt;,&lt;gain&gt;,&lt;offset&gt;,&lt;undetect&gt;,&lt;nodata&gt;  &lt;commands&gt;</div>
</div><!-- fragment --><p> and for polar products and conversions, the extended form is: </p><div class="fragment"><div class="line">rack &lt;input&gt;  --encoding &lt;type&gt;,&lt;gain&gt;,&lt;offset&gt;,&lt;undetect&gt;,&lt;nodata&gt;,&lt;rscale&gt;,&lt;nrays&gt;,&lt;nbins&gt;  &lt;commands&gt;</div>
</div><!-- fragment --><p>One may set one or more properties by giving only N first ones. Also <code>key=value</code> forms are supported. <br  />
 The typical choices for storage type are 'C' (unsigned char), 'S' (unsigned short int) and 'd' (double precision float). The next parameters <code>gain</code> and <code>offset</code> define the mapping between bit values and the physical quantity: <em>f</em> = <code>gain</code> * <em>x</em> + <code>offset</code> . <br  />
 In ODIM standard, <code>undetect</code> marks the data where a measurement value falls under a sensitivity limit and <code>nodata</code> marks areas where no measurement at all is available. Also grid geometry (<code>nbins</code> , <code>nrays</code> and <code>rscale</code> ) can be set when applicable. For example, producing a polar product (here 500m CAPPI, see <a class="el" href="productspage.html">Meteorological products</a>) with some desired properties is given by: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --encoding C,0.4,-20,rscale=1000,nbins=250  --pCappi 500 -o cappi-500.h5</div>
</div><!-- fragment --><p> <b>Rack</b> provides default encodings for some quantities. The configuration can be listed and changed with <code>&ndash;quantityConf</code> command.</p>
<p>As to hierarchical structure of resulting products, the default location of computed meteorological products and Composites is <code>/dataset1/data1</code> . Any previous results are overwritten. This can be changed by means of <code>&ndash;append</code> command: one can combine several products in same <code>dataset</code> group, adding a new <code>data</code> group, or append a new <code>dataset</code> group.</p>
<p>For modifying existing data, see <a class="el" href="modifypage.html">Modifying data</a> .</p>
<h2><a class="anchor" id="quantityConf"></a>
Default encoding of quantities</h2>
<p>Measurement parameters in radar have a varying scale. For example, DBZH is typically between -32dBZ and 50dBZ whereas RHOHV ranges between 0.0 and 1.0. Further, different storage types can be used, and the resulting value range should be compatible with the encoding. In some cases, like in creating radar image composites, <b>Rack</b> can use predefined storage types and encoding. The following examples illustrate the usage</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --quantityConf DBZH:S          # <span class="keywordflow">for</span> encoding dBZ, use <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int, with <span class="keywordflow">default</span> scaling</div>
<div class="line"><a class="code" href="namespacerack.html">rack</a> --quantityConf DBZH:C,0.6,-30  # <span class="keywordflow">for</span> encoding dBZ, use <span class="keywordtype">unsigned</span> char, with gain=0.5 and offset=-32</div>
</div><!-- fragment --><p>The arguments can be named explicitly, as in the case of <code>&ndash;select</code> and <code>&ndash;encoding</code> . The encoding of a given quantity is displayed if the quantity is issued without type specifier character. A quantity can be also assigned <code>zero</code>, a "virtual" physical small value to be applied instead of <code>undetect</code> marker.</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --quantityConf <span class="stringliteral">&#39;DBZH&#39;</span></div>
</div><!-- fragment --><p>yelding </p><div class="fragment"><div class="line">DBZH</div>
<div class="line">  *C,<span class="stringliteral">&quot;what:gain&quot;</span>=0.5,<span class="stringliteral">&quot;what:nodata&quot;</span>=255,<span class="stringliteral">&quot;what:offset&quot;</span>=-32,<span class="stringliteral">&quot;what:type&quot;</span>=<span class="stringliteral">&quot;C&quot;</span>,<span class="stringliteral">&quot;what:undetect&quot;</span>=0 (min=-31.5)</div>
<div class="line">   S,<span class="stringliteral">&quot;what:gain&quot;</span>=0.01,<span class="stringliteral">&quot;what:nodata&quot;</span>=65535,<span class="stringliteral">&quot;what:offset&quot;</span>=-327.68,<span class="stringliteral">&quot;what:type&quot;</span>=<span class="stringliteral">&quot;S&quot;</span>,<span class="stringliteral">&quot;what:undetect&quot;</span>=0 (min=-327.67)</div>
<div class="line">    <span class="keyword">virtual</span> zero=-32</div>
</div><!-- fragment --><p> where asterisk <code>*</code> marks the current default storage type and scaling.</p>
<p>The full list of predefined quantity encodings are listed with </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --quantityConf <span class="stringliteral">&#39;&#39;</span></div>
</div><!-- fragment --><p> One may freely add encodings simply by setting them with <code>&ndash;quantityConf</code> </p>
<dl class="section author"><dt>Author</dt><dd>Markus Peura, Seppo Pulkkinen (HDF5 support), Joonas Karjalainen </dd></dl>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
</html>
